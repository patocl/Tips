# Obtener la lista de usuarios locales con net user y guardarla en un archivo
net user > usuarios_locales.txt

# Leer el archivo y procesar cada línea
$usuariosLocales = Get-Content -Path usuarios_locales.txt | Where-Object { $_ -like "  *" } | ForEach-Object { $_.Trim() }

# Cargar el módulo de Active Directory
Import-Module ActiveDirectory

# Función para obtener la información detallada de un usuario de dominio
function Get-DomainUserDetails {
    param (
        [string]$userName
    )

    # Obtener el usuario de dominio con información detallada
    $user = Get-ADUser -Identity $userName -Properties MemberOf

    if ($user) {
        Write-Output "User: $($user.SamAccountName)"
        Write-Output "Description: $($user.Description)"
        Write-Output "Account Type: Domain User"

        # Obtener los grupos a los que pertenece el usuario
        $userGroups = $user.MemberOf | ForEach-Object { Get-ADGroup $_ }
        if ($userGroups) {
            Write-Output "Group Memberships:"
            foreach ($group in $userGroups) {
                Write-Output "- $($group.Name)"
            }
        } else {
            Write-Output "User is not a member of any groups."
        }
    } else {
        Write-Output "User $userName not found in the domain."
    }
}

# Procesar cada usuario y obtener la información detallada
foreach ($usuario in $usuariosLocales) {
    Write-Output "------------------------------------------------------"
    Write-Output "Local User: $usuario"

    # Obtener información detallada de usuarios de dominio
    Get-DomainUserDetails -userName $usuario
}